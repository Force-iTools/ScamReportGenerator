{"version":3,"sources":["App.js","index.js"],"names":["districtCode","districtFullName","formatizePhoneNUmber","phone_num","slice","formatizeScamList","scam_list","scams","split","tableString","i","length","header","String","fromCharCode","replace","formatizeOCName","name","perfectNameLength","startSpace","Math","ceil","repeat","getDistrictFullName","rn_no","code","indexOf","j","App","useState","rnValue","setRnValue","faxValue","setFaxValue","telValue","setTelValue","className","Form","onSubmit","e","preventDefault","url","callback","formData","FormData","target","ref_no","get","fax_no","tel_no","errorMsg","startsWith","phoneRegex","match","formValidation","error","content","console","log","pzip","PizZip","doc","Docxtemplater","paragraphLoop","linebreaks","setData","district_name","date","Date","toJSON","oc_name","team_no","render","err","out","getZip","generate","type","mimeType","saveAs","PizZipUtils","getBinaryContent","alert","Group","InputGroup","Text","Control","as","required","value","onChange","event","result","placeholder","rows","Button","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.519997be.chunk.js","sourcesContent":["import Docxtemplater from \"docxtemplater\";\nimport PizZip from \"pizzip\";\nimport PizZipUtils from \"pizzip/utils/index.js\";\nimport { saveAs } from \"file-saver\";\nimport Form from 'react-bootstrap/Form';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport Button from \"react-bootstrap/Button\";\nimport { useState } from \"react\";\nimport \"../src/App.css\";\n\nlet districtCode = [\n    [\"YMT\", \"TST\"],\n    [\"MK\"],\n    [\"CSW\", \"SSPO\"],\n    [\"KC\", \"HH\"]\n]\n\n/*\n12345678\n22345678\n32345678\n42345678\n52345678\n62345678\n72345678\n*/\n\nconst perfectNameLength = 25\nlet districtFullName = [\"Yau Tsim\", \"Mong Kok\", \"Sham Shui Po\", \"Kowloon City\"]\n\nfunction formValidation(ref_no, fax_no, tel_no) {\n    let errorMsg = \"The entered case RN is invalid\\n\";\n    for (let i = 0; i < districtCode.length; i++) {\n        for (let j = 0; j < districtCode[i].length; j++) {\n            if (ref_no.startsWith(districtCode[i][j] + \"RN\")) {\n                errorMsg = \"\";\n                break;\n            }\n        }\n    }\n    let phoneRegex = /^\\d{8}$/;\n\n    if (!fax_no.match(phoneRegex))\n        errorMsg += \"The entered fax number is invalid\\n\";\n\n    if (!tel_no.match(phoneRegex))\n        errorMsg += \"The entered telephone number is invalid\\n\";\n\n    return errorMsg;\n}\n\nfunction formatizePhoneNUmber(phone_num) {\n    return phone_num.slice(0, 4) + \" \" + phone_num.slice(4);\n}\n\nfunction formatizeCaseRN(rn_no) {\n    return rn_no.slice(0, rn_no.indexOf(\"RN\")) + \" \" + \"RN\" + \" \" + rn_no.slice(rn_no.indexOf(\"RN\") + 2);\n}\n\nfunction formatizeScamList(scam_list) {\n    let scams = scam_list.split(\"\\n\");\n    let tableString = \"\";\n    for (let i = 0; i < scams.length; i++) {\n        let header = \"(\" + String.fromCharCode(97 + i) + \") \";\n        let formatPhone = scams[i].replace(\" \", \"\");\n        let phoneLength = formatPhone.length;\n\n        if (phoneLength == 8)\n            header += \"+852 \";\n\n        tableString = header + scams[i];\n\n        if ((i+1) % 3 == 0)\n            tableString += \"\\n\" + \"      \";\n        else\n            tableString += \"        \";\n    }\n    return tableString\n}\n\nfunction formatizeOCName(name) {\n    if (name.length < perfectNameLength) {\n        //Special Case : 24 Characters\n        if (name.length == perfectNameLength - 1) {\n            name = \" \" + name + \" \";\n        } else {\n            let startSpace = Math.ceil((perfectNameLength - name.length) / 2);\n            name = \" \".repeat(startSpace) + name + \" \".repeat(startSpace);\n        }\n    } else {\n        name = \" \" + name + \" \";\n    }\n    return name;\n}\n\nfunction getDistrictFullName(rn_no) {\n    let code = rn_no.slice(0, rn_no.indexOf(\"RN\"));\n    for (let i = 0; i < districtCode.length; i++) {\n        for (let j = 0; j < districtCode[i].length; j++) {\n            if (districtCode[i][j] == code)\n                return districtFullName[i];\n        }\n    }\n}\n\nfunction getTodayDate() {\n    return new Date().toJSON().slice(0, 10);\n}\n\nfunction App() {\n    const [ifr, setIfr] = useState(null);\n    const [rnValue, setRnValue] = useState('');\n    const [faxValue, setFaxValue] = useState('');\n    const [telValue, setTelValue] = useState('');\n\n    const rnChange = event => {\n        const result = event.target.value.replace(/\\D/g, '');\n        setRnValue(result.slice(0, 8));\n    }\n\n    const faxChange = event => {\n        const result = event.target.value.replace(/\\D/g, '');\n        setFaxValue(result.slice(0, 8));\n    }\n\n    const telChange = event => {\n        const result = event.target.value.replace(/\\D/g, '');\n        setTelValue(result.slice(0, 8));\n    }\n\n    const submitHandler = (e) => {\n        e.preventDefault();\n        let formData = new FormData(e.target);\n        let ref_no = formData.get(\"dis_code\") + \"RN\" + formData.get(\"ref_no\");\n        let fax_no = formData.get(\"fax_no\");\n        let tel_no = formData.get(\"tel_no\");\n        let errorMsg = formValidation(ref_no, fax_no, tel_no);\n        if (errorMsg.length == 0) {\n            loadFile(\"./template.docx\", function (error, content) {\n                if (error) console.log(error);\n                let pzip = new PizZip(content);\n                let doc = new Docxtemplater(pzip, {\n                    paragraphLoop: true,\n                    linebreaks: true\n                  });\n                doc.setData({\n                    ref_no: formatizeCaseRN(ref_no),\n                    fax_no: formatizePhoneNUmber(fax_no),\n                    tel_no: formatizePhoneNUmber(tel_no),\n                    district_name: getDistrictFullName(ref_no),\n                    date: getTodayDate(),\n                    scam_list: formatizeScamList(formData.get(\"scam_list\")),\n                    oc_name: formatizeOCName(formData.get(\"oc_name\")),\n                    team_no: formData.get(\"team_no\")\n                });\n                try {\n                    doc.render();\n                } catch (err) {\n                    console.log(err);\n                }\n                var out = doc.getZip().generate({\n                    type: \"blob\",\n                    mimeType:\n                        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n                });\n                saveAs(out, \"Request for take down.docx\");\n            });\n        } else {\n            alert(errorMsg);\n        }\n    };\n    function loadFile(url, callback) {\n        PizZipUtils.getBinaryContent(url, callback);\n    }\n    return (\n        <div className=\"App\">\n            <p/><h4>舉報可疑WhatsApp信件範本</h4><p/>\n            <div className=\"container\">\n                <Form onSubmit={submitHandler}>\n                    <Form.Group>\n                        <InputGroup>\n                            <InputGroup.Text>Case RN</InputGroup.Text>\n                            <Form.Control as=\"select\" type=\"select\" name=\"dis_code\" className=\"districtSelect\" required>\n                                <option value=\"YMT\">YMT</option>\n                                <option value=\"TST\">TST</option>\n                                <option value=\"MK\">MK</option>\n                                <option value=\"CSW\">CSW</option>\n                                <option value=\"SSPO\">SSPO</option>\n                                <option value=\"KC\">KC</option>\n                                <option value=\"HH\">HH</option>\n                            </Form.Control>\n                            <InputGroup.Text>RN</InputGroup.Text>\n                            <Form.Control type=\"text\" name=\"ref_no\" value={rnValue} onChange={rnChange} required />\n                        </InputGroup>\n                    </Form.Group>\n\n                    <Form.Group>\n                        <InputGroup>\n                            <InputGroup.Text>Office Fax No.</InputGroup.Text>\n                            <Form.Control type=\"text\" name=\"fax_no\" value={faxValue} onChange={faxChange} required />\n                        </InputGroup>\n                    </Form.Group>\n\n                    <Form.Group>\n                        <InputGroup>\n                            <InputGroup.Text>Office Tel No.</InputGroup.Text>\n                            <Form.Control type=\"text\" name=\"tel_no\" value={telValue} onChange={telChange} required />\n                        </InputGroup>\n                    </Form.Group>\n\n                    <Form.Group>\n                        <InputGroup>\n                            <InputGroup.Text>Name of OC</InputGroup.Text>\n                            <Form.Control type=\"text\" name=\"oc_name\" placeholder=\"CHAN Tai-man\" required />\n                        </InputGroup>\n                    </Form.Group>\n\n                    <Form.Group>\n                        <InputGroup>\n                            <InputGroup.Text>DIT Unit</InputGroup.Text>\n                            <Form.Control as=\"select\" type=\"select\" name=\"team_no\" required>\n                                <option value=\"1\">Team 1</option>\n                                <option value=\"2\">Team 2</option>\n                                <option value=\"3\">Team 3</option>\n                                <option value=\"4\">Team 4</option>\n                                <option value=\"5\">Team 5</option>\n                                <option value=\"6\">Team 6</option>\n                                <option value=\"7\">Team 7</option>\n                                <option value=\"8\">Team 8</option>\n                                <option value=\"9\">Team 9</option>\n                                <option value=\"10\">Team 10</option>\n                            </Form.Control>\n                        </InputGroup>\n                    </Form.Group>\n\n                    <Form.Group>\n                        <InputGroup.Text>Suspicous Whatsapp Accounts</InputGroup.Text>\n                        <Form.Control name=\"scam_list\" as=\"textarea\" rows=\"7\" placeholder=\"每行輸入一組可疑WhatsApp號碼，本地號碼無需輸入+852，非本地號碼需輸入國際電話區號。\"/>\n                    </Form.Group>\n                    <Button type=\"Submit\">Generate</Button>\n                </Form>\n            </div>\n        </div>\n      );\n    }\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"../node_modules/bootstrap/dist/css/bootstrap.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}