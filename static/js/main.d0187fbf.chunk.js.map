{"version":3,"sources":["App.js","index.js"],"names":["districtCode","districtFullName","formatizePhoneNUmber","phone_num","slice","formatizeScamList","scam_list","scams","split","tableString","i","length","String","fromCharCode","formatizeOCName","name","perfectNameLength","startSpace","Math","ceil","repeat","getDistrictFullName","rn_no","code","indexOf","j","App","useState","rnValue","setRnValue","faxValue","setFaxValue","telValue","setTelValue","className","Form","onSubmit","e","preventDefault","url","callback","formData","FormData","target","ref_no","get","fax_no","tel_no","errorMsg","startsWith","phoneRegex","match","formValidation","error","content","console","log","pzip","PizZip","doc","Docxtemplater","paragraphLoop","linebreaks","setData","district_name","date","Date","toJSON","oc_name","team_no","render","err","out","getZip","generate","type","mimeType","saveAs","PizZipUtils","getBinaryContent","alert","Group","InputGroup","Text","Control","as","required","value","onChange","event","result","replace","placeholder","rows","Button","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d0187fbf.chunk.js","sourcesContent":["import Docxtemplater from \"docxtemplater\";\r\nimport PizZip from \"pizzip\";\r\nimport PizZipUtils from \"pizzip/utils/index.js\";\r\nimport { saveAs } from \"file-saver\";\r\nimport Form from 'react-bootstrap/Form';\r\nimport InputGroup from 'react-bootstrap/InputGroup';\r\nimport Button from \"react-bootstrap/Button\";\r\nimport { useState } from \"react\";\r\nimport \"../src/App.css\";\r\n\r\nlet districtCode = [\r\n    [\"YMT\", \"TST\"],\r\n    [\"MK\"],\r\n    [\"CSW\", \"SSPO\"],\r\n    [\"KC\", \"HH\"]\r\n]\r\n\r\n/*\r\n12345678\r\n22345678\r\n32345678\r\n42345678\r\n52345678\r\n62345678\r\n72345678\r\n*/\r\n\r\nconst perfectNameLength = 25\r\nlet districtFullName = [\"Yau Tsim\", \"Mong Kok\", \"Sham Shui Po\", \"Kowloon City\"]\r\n\r\nfunction formValidation(ref_no, fax_no, tel_no) {\r\n    let errorMsg = \"The entered case RN is invalid\\n\";\r\n    for (let i = 0; i < districtCode.length; i++) {\r\n        for (let j = 0; j < districtCode[i].length; j++) {\r\n            if (ref_no.startsWith(districtCode[i][j] + \"RN\")) {\r\n                errorMsg = \"\";\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    let phoneRegex = /^\\d{8}$/;\r\n\r\n    if (!fax_no.match(phoneRegex))\r\n        errorMsg += \"The entered fax number is invalid\\n\";\r\n\r\n    if (!tel_no.match(phoneRegex))\r\n        errorMsg += \"The entered telephone number is invalid\\n\";\r\n\r\n    return errorMsg;\r\n}\r\n\r\nfunction formatizePhoneNUmber(phone_num) {\r\n    return phone_num.slice(0, 4) + \" \" + phone_num.slice(4);\r\n}\r\n\r\nfunction formatizeCaseRN(rn_no) {\r\n    return rn_no.slice(0, rn_no.indexOf(\"RN\")) + \" \" + \"RN\" + \" \" + rn_no.slice(rn_no.indexOf(\"RN\") + 2);\r\n}\r\n\r\nfunction formatizeScamList(scam_list) {\r\n    let scams = scam_list.split(\"\\n\");\r\n    let tableString = \"\";\r\n    for (let i = 0; i < scams.length; i++) {\r\n        tableString += \"(\" + String.fromCharCode(97 + i) + \")\" + scams[i];\r\n        if ((i+1) % 3 == 0)\r\n            tableString += \"\\n\" + \"      \";\r\n        else\r\n            tableString += \"        \";\r\n    }\r\n    return tableString\r\n}\r\n\r\nfunction formatizeOCName(name) {\r\n    if (name.length < perfectNameLength) {\r\n        //Special Case : 24 Characters\r\n        if (name.length == perfectNameLength - 1) {\r\n            name = \" \" + name + \" \";\r\n        } else {\r\n            let startSpace = Math.ceil((perfectNameLength - name.length) / 2);\r\n            name = \" \".repeat(startSpace) + name + \" \".repeat(startSpace);\r\n        }\r\n    } else {\r\n        name = \" \" + name + \" \";\r\n    }\r\n    return name;\r\n}\r\n\r\nfunction getDistrictFullName(rn_no) {\r\n    let code = rn_no.slice(0, rn_no.indexOf(\"RN\"));\r\n    for (let i = 0; i < districtCode.length; i++) {\r\n        for (let j = 0; j < districtCode[i].length; j++) {\r\n            if (districtCode[i][j] == code)\r\n                return districtFullName[i];\r\n        }\r\n    }\r\n}\r\n\r\nfunction getTodayDate() {\r\n    return new Date().toJSON().slice(0, 10);\r\n}\r\n\r\nfunction App() {\r\n    const [ifr, setIfr] = useState(null);\r\n    const [rnValue, setRnValue] = useState('');\r\n    const [faxValue, setFaxValue] = useState('');\r\n    const [telValue, setTelValue] = useState('');\r\n\r\n    const rnChange = event => {\r\n        const result = event.target.value.replace(/\\D/g, '');\r\n        setRnValue(result.slice(0, 8));\r\n    }\r\n\r\n    const faxChange = event => {\r\n        const result = event.target.value.replace(/\\D/g, '');\r\n        setFaxValue(result.slice(0, 8));\r\n    }\r\n\r\n    const telChange = event => {\r\n        const result = event.target.value.replace(/\\D/g, '');\r\n        setTelValue(result.slice(0, 8));\r\n    }\r\n\r\n    const submitHandler = (e) => {\r\n        e.preventDefault();\r\n        let formData = new FormData(e.target);\r\n        let ref_no = formData.get(\"dis_code\") + \"RN\" + formData.get(\"ref_no\");\r\n        let fax_no = formData.get(\"fax_no\");\r\n        let tel_no = formData.get(\"tel_no\");\r\n        let errorMsg = formValidation(ref_no, fax_no, tel_no);\r\n        if (errorMsg.length == 0) {\r\n            loadFile(\"./template.docx\", function (error, content) {\r\n                if (error) console.log(error);\r\n                let pzip = new PizZip(content);\r\n                let doc = new Docxtemplater(pzip, {\r\n                    paragraphLoop: true,\r\n                    linebreaks: true\r\n                  });\r\n                doc.setData({\r\n                    ref_no: formatizeCaseRN(ref_no),\r\n                    fax_no: formatizePhoneNUmber(fax_no),\r\n                    tel_no: formatizePhoneNUmber(tel_no),\r\n                    district_name: getDistrictFullName(ref_no),\r\n                    date: getTodayDate(),\r\n                    scam_list: formatizeScamList(formData.get(\"scam_list\")),\r\n                    oc_name: formatizeOCName(formData.get(\"oc_name\")),\r\n                    team_no: formData.get(\"team_no\")\r\n                });\r\n                try {\r\n                    doc.render();\r\n                } catch (err) {\r\n                    console.log(err);\r\n                }\r\n                var out = doc.getZip().generate({\r\n                    type: \"blob\",\r\n                    mimeType:\r\n                        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n                });\r\n                saveAs(out, \"Request for take down.docx\");\r\n            });\r\n        } else {\r\n            alert(errorMsg);\r\n        }\r\n    };\r\n    function loadFile(url, callback) {\r\n        PizZipUtils.getBinaryContent(url, callback);\r\n    }\r\n    return (\r\n        <div className=\"App\">\r\n            <p/><h4>舉報可疑WhatsApp信件範本</h4><p/>\r\n            <div className=\"container\">\r\n                <Form onSubmit={submitHandler}>\r\n                    <Form.Group>\r\n                        <InputGroup>\r\n                            <InputGroup.Text>Case RN</InputGroup.Text>\r\n                            <Form.Control as=\"select\" type=\"select\" name=\"dis_code\" className=\"districtSelect\" required>\r\n                                <option value=\"YMT\">YMT</option>\r\n                                <option value=\"TST\">TST</option>\r\n                                <option value=\"MK\">MK</option>\r\n                                <option value=\"CSW\">CSW</option>\r\n                                <option value=\"SSPO\">SSPO</option>\r\n                                <option value=\"KC\">KC</option>\r\n                                <option value=\"HH\">HH</option>\r\n                            </Form.Control>\r\n                            <InputGroup.Text>RN</InputGroup.Text>\r\n                            <Form.Control type=\"text\" name=\"ref_no\" value={rnValue} onChange={rnChange} required />\r\n                        </InputGroup>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group>\r\n                        <InputGroup>\r\n                            <InputGroup.Text>Office Fax No.</InputGroup.Text>\r\n                            <Form.Control type=\"text\" name=\"fax_no\" value={faxValue} onChange={faxChange} required />\r\n                        </InputGroup>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group>\r\n                        <InputGroup>\r\n                            <InputGroup.Text>Office Tel No.</InputGroup.Text>\r\n                            <Form.Control type=\"text\" name=\"tel_no\" value={telValue} onChange={telChange} required />\r\n                        </InputGroup>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group>\r\n                        <InputGroup>\r\n                            <InputGroup.Text>Name of OC</InputGroup.Text>\r\n                            <Form.Control type=\"text\" name=\"oc_name\" placeholder=\"CHAN Tai-man\" required />\r\n                        </InputGroup>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group>\r\n                        <InputGroup>\r\n                            <InputGroup.Text>DIT Unit</InputGroup.Text>\r\n                            <Form.Control as=\"select\" type=\"select\" name=\"team_no\" required>\r\n                                <option value=\"1\">Team 1</option>\r\n                                <option value=\"2\">Team 2</option>\r\n                                <option value=\"3\">Team 3</option>\r\n                                <option value=\"4\">Team 4</option>\r\n                                <option value=\"5\">Team 5</option>\r\n                                <option value=\"6\">Team 6</option>\r\n                                <option value=\"7\">Team 7</option>\r\n                                <option value=\"8\">Team 8</option>\r\n                                <option value=\"9\">Team 9</option>\r\n                                <option value=\"10\">Team 10</option>\r\n                            </Form.Control>\r\n                        </InputGroup>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group>\r\n                        <InputGroup.Text>Suspicous Whatsapp Accounts</InputGroup.Text>\r\n                        <Form.Control name=\"scam_list\" as=\"textarea\" rows=\"7\" placeholder=\"每行輸入一組可疑WhatsApp號碼，本地號碼無需輸入+852，非本地號碼需輸入國際電話區號。\"/>\r\n                    </Form.Group>\r\n                    <Button type=\"Submit\">Generate</Button>\r\n                </Form>\r\n            </div>\r\n        </div>\r\n      );\r\n    }\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport \"../node_modules/bootstrap/dist/css/bootstrap.css\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}